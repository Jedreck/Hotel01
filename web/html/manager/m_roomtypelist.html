<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Dashboard">
    <meta name="keyword" content="Dashboard, Bootstrap, Admin, Template, Theme, Responsive, Fluid, Retina">
    <title>房间类型列表</title>

    <!-- Favicons -->
    <link href="../../img/favicon.png" rel="icon">
    <link href="../../img/apple-touch-icon.png" rel="apple-touch-icon">

    <!-- Bootstrap core CSS -->
    <link href="../../lib/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <!--external css-->
    <link href="../../lib/font-awesome/css/font-awesome.css" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="../../css/zabuto_calendar.css">
    <link rel="stylesheet" type="text/css" href="../../lib/gritter/css/jquery.gritter.css" />
    <!-- Custom styles for this template -->
    <link href="../../css/style.css" rel="stylesheet">
    <link href="../../css/style-responsive.css" rel="stylesheet">
    <link rel="stylesheet" href="../../lib/layui/css/layui.css" media="all">
    <script src="../../lib/chart-master/Chart.js"></script>
    <style type="text/css">
        #test1{
            width: 100%;
            text-align: center;
            vertical-align: center;
            margin: 20px;
        }
    </style>

    <!-- =======================================================
      Template Name: Dashio
      Template URL: https://templatemag.com/dashio-bootstrap-admin-template/
      Author: TemplateMag.com
      License: https://templatemag.com/license/
    ======================================================= -->
</head>

<body>
<section id="container">
    <!-- **********************************************************************************************************************************************************
        TOP BAR CONTENT & NOTIFICATIONS
        *********************************************************************************************************************************************************** -->
    <!--header start-->
    <header class="header black-bg">
        <div class="sidebar-toggle-box">
            <div class="fa fa-bars tooltips" data-placement="right" data-original-title="Toggle Navigation"></div>
        </div>
        <!--logo start-->
        <a href="../common/index.html" class="logo"><b>酒店<span>预订</span></b></a>
        <!--logo end-->
        <div class="top-menu">
            <ul class="nav pull-right top-menu">
                <li><a class="logout" href="../common/index.html">登出</a></li>
            </ul>
        </div>
    </header>
    <!--header end-->
    <!-- **********************************************************************************************************************************************************
        MAIN SIDEBAR MENU
        *********************************************************************************************************************************************************** -->
    <!--sidebar start-->
    <aside>
        <div id="sidebar" class="nav-collapse ">
            <!-- sidebar menu start-->
            <ul class="sidebar-menu" id="nav-accordion">
                <p class="centered"><a href="profile.html"><img src="../../img/ui-sam.jpg" class="img-circle"
                                                                width="80"></a></p>
                <h5 class="centered">Sam Soffes</h5>

                <li class="mt">
                    <a href="#">
                        <i class="fa fa-home"></i>
                        <span>首页</span>
                    </a>
                </li>

                <li class="sub-menu">
                    <a href="javascript:;">
                        <i class="fa fa-users"></i>
                        <span>客户管理</span>
                    </a>
                    <ul class="sub">
                        <li><a href="m_clist.html">客户列表</a></li>
                    </ul>
                </li>

                <li class="sub-menu">
                    <a href="javascript:;">
                        <i class="fa fa-group"></i>
                        <span>员工管理</span>
                    </a>
                    <ul class="sub">
                        <li><a href="m_stalist.html">员工列表</a></li>
                        <li><a href="m_addsta.html">添加员工</a></li>
                    </ul>
                </li>

                <li class="sub-menu">
                    <a class="active" href="javascript:;">
                        <i class="fa fa-edit"></i>
                        <span>客房管理</span>
                    </a>
                    <ul class="sub">
                        <li><a href="m_roomtypelist.html">客房类型列表</a></li>
                        <li><a href="m_addRoomType.html">添加客房类型</a></li>
                    </ul>
                </li>

                <li class="sub-menu">
                    <a href="javascript:;">
                        <i class="fa fa-edit"></i>
                        <span>数据详情</span>
                    </a>
                    <ul class="sub">
                        <li><a href="m_cdataAnalysis.html">顾客的数据详情</a></li>
                        <li><a href="m_addRoomType.html">员工的数据详情</a></li>
                    </ul>
                </li>

                <li class="sub-menu">
                    <a class="" href="#">
                        <i class="glyphicon glyphicon-time"></i>
                        <span>预订客房管理</span>
                    </a>
                </li>
            </ul>
            <!-- sidebar menu end-->
        </div>
    </aside>
    <!--sidebar end-->
    <!-- **********************************************************************************************************************************************************
        MAIN CONTENT
        *********************************************************************************************************************************************************** -->
    <!--main content start-->
    <section id="main-content">
        <section class="wrapper">
            <!--表格-->
            <div class="row mt" style="height: 600px">
                <div class="col-md-12">
                    <div class="content-panel">
                        <table class="table table-striped table-advance table-hover">
                            <h3 style="margin-top: 10px"><i class="fa fa-angle-right"></i> 房间类型列表</h3>
                            <hr>
                            <thead>
                            <tr>
                                <th colspan="5">
                                    <div style="width: 100%;height: 100%">
                                        <div class="form-panel" style="text-align: center">
                                            <form class="form-inline" role="form">
                                                <div class="form-group">
                                                    <input type="text" class="form-control" id="search_name" placeholder="房间类型">
                                                </div>
                                                <button type="button" class="btn btn-theme" id="search" name="search"><i class="fa fa-search"></i>>搜索</button>
                                                <!--多删除-->
                                                <!--<div style="float: right;">-->
                                                <!--<div style="float: left;text-align: center;padding: 5px"><label>多选</label></div>-->
                                                <!--<div style="float: right">-->
                                                <!--<div class="switch switch-square" data-on-label="<i class=' fa fa-check'></i>" data-off-label="<i class='fa fa-times'></i>">-->
                                                <!--<input type="checkbox" id="multiopt"/>-->
                                                <!--</div>-->
                                                <!--</div>-->
                                                <!--</div>-->
                                            </form>
                                        </div>
                                    </div>
                                </th>
                            </tr>
                            <tr>
                                <th><i class="fa fa-sort-numeric-asc"></i> 房间类型编号</th>
                                <th><i class="fa fa-th-list"></i> 房间类型</th>
                                <th class="hidden-phone"><i class="fa fa-bookmark-o"></i> 床型</th>
                                <th class="hidden-phone"><i class="fa fa-rmb"></i> 价格</th>
                                <th><i class="fa fa-users"></i> 人数</th>
                                <th><i class="fa fa-pencil-square"></i> 操作</th>
                            </tr>
                            </thead>
                            <tbody id="table_content">
                            <!--<tr>-->
                                <!--<td id="E_num">123</td>-->
                                <!--<td id="E_ID">Company Ltd</td>-->
                                <!--<td class="hidden-phone" id="E_name">Lorem Ipsum dolor</td>-->
                                <!--<td class="hidden-phone" id="E_sex">Lorem Ipsum dolor</td>-->
                                <!--<td id="E_position">3</td>-->
                                <!--<td>-->
                                    <!--<button class="btn btn-success btn-xs" name="detail"><i class="fa fa-exclamation-circle"></i></button>-->
                                    <!--<button class="btn btn-primary btn-xs" name="detail"><i class="fa fa-pencil"></i></button>-->
                                    <!--<button class="btn btn-danger btn-xs"  name="delete"><i class="fa fa-trash-o "></i></button>-->
                                <!--</td>-->
                            <!--</tr>-->
                            <!--<tr>-->
                                <!--<td>-->
                                    <!--<a href="#">Company Ltd</a>-->
                                <!--</td>-->
                                <!--<td class="hidden-phone">Lorem Ipsum dolor</td>-->
                                <!--<td><i class="fa fa-male"></i>男</td>-->
                                <!--<td>-->
                                    <!--<button class="btn btn-success btn-xs" name="detail"><i class="fa fa-exclamation-circle"></i></button>-->
                                    <!--<button class="btn btn-primary btn-xs" name="detail"><i class="fa fa-pencil"></i></button>-->
                                    <!--<button class="btn btn-danger btn-xs"  name="delete"><i class="fa fa-trash-o "></i></button>-->
                                <!--</td>-->
                            <!--</tr>-->
                            <!--<tr>-->
                                <!--<td>-->
                                    <!--<a href="basic_table.html#">张三</a>-->
                                <!--</td>-->
                                <!--<td class="hidden-phone">123</td>-->
                                <!--<td><i class="fa fa-male"></i>男</td>-->
                                <!--<td>-->
                                    <!--<button class="btn btn-success btn-xs" name="detail"><i class="fa fa-exclamation-circle"></i></button>-->
                                    <!--<button class="btn btn-primary btn-xs" name="detail"><i class="fa fa-pencil"></i></button>-->
                                    <!--<button class="btn btn-danger btn-xs"  name="delete"><i class="fa fa-trash-o "></i></button>-->
                                <!--</td>-->
                            <!--</tr>-->
                            <!--</tbody>-->
                        </table>
                    </div>
                    <!-- /content-panel -->
                </div>
                <!-- /col-md-12 -->
            </div>
            <!-- /row -->
            <!--分页-->
            <div id="test1"></div>
        </section>
    </section>
    <!--main content end-->

    <!--footer start-->
    <footer class="site-footer">
        <div class="text-center">
            <p>
                &copy; Copyrights <strong>Dashio</strong>. All Rights Reserved
            </p>
            <div class="credits">
                <!--
                  You are NOT allowed to delete the credit link to TemplateMag with free version.
                  You can delete the credit link only if you bought the pro version.
                  Buy the pro version with working PHP/AJAX contact form: https://templatemag.com/dashio-bootstrap-admin-template/
                  Licensing information: https://templatemag.com/license/
                -->
                Created with Dashio template by <a href="https://templatemag.com/">TemplateMag</a>
            </div>
            <a href="index.html#" class="go-top">
                <i class="fa fa-angle-up"></i>
            </a>
        </div>
    </footer>
    <!--footer end-->
</section>
<!-- js placed at the end of the document so the pages load faster -->
<script src="../../lib/jquery/jquery.min.js"></script>

<script src="../../lib/bootstrap/js/bootstrap.min.js"></script>
<script class="include" type="text/javascript" src="../../lib/jquery.dcjqaccordion.2.7.js"></script>
<script src="../../lib/jquery.scrollTo.min.js"></script>
<script src="../../lib/jquery.nicescroll.js" type="text/javascript"></script>
<script src="../../lib/jquery.sparkline.js"></script>
<!--common script for all pages-->
<script src="../../lib/common-scripts.js"></script>
<script type="text/javascript" src="../../lib/gritter/js/jquery.gritter.js"></script>
<script type="text/javascript" src="../../lib/gritter-conf.js"></script>
<!--script for this page-->
<script src="../../lib/sparkline-chart.js"></script>
<script src="../../lib/zabuto_calendar.js"></script>
<script src="../../lib/jquery-ui-1.9.2.custom.min.js"></script>
<!--custom switch-->
<script src="../../lib/bootstrap-switch.js"></script>

<script src="../../lib/layui/layui.js"></script>

<script>
    layui.use(['laypage','form','layer'], function(){
        var form = layui.form;
        var laypage = layui.laypage;
        var layer = layui.layer;
    });
</script>

<script type="application/javascript">
    $(document).ready(function() {
        var pageNum = 0;
        var obj;
        initialData();
        function initialData() {
            console.log("222222222222");
            getData(0);  //初始化获取第0页数据
        }
        // 根据页号获取数据
        function getData(page) {
            $.ajax({
                url: "/SelectAllRoomTypeServlet",
                type:'post',
                data:{page:page},
                dataType:'text',
                success: function(data){
                    // 后台查询失败
                    if(data == "Error") {
                        $("#table_content").html("1加载数据失败，请稍后重试!");
                        return;
                    }
                    obj = JSON.parse(data);
                    // 后台没有数据
                    if(obj.length == 0) {
                        $("#table_content").html("没有房间类型!");
                        return
                    }
                    // 后台有>=1条数据
                    initialTable(obj);
                },
                error: function () {
                    $("#table_content").html("2加载数据失败，请稍后重试!");
                }
            });
        }
        // 初始化表格
        function initialTable(obj){
            pageNum = obj.length;
            setPage(pageNum);
            var html = "";
            for(var i = 0; i < obj.length; i++){
                // 拼接内容
                html += "<tr>\n" +
                    "                                <td name=\"roomnum\">";
                html += obj[i].R_roomtype;
                html += "        </td>\n" +
                    "            <td name=\"R_roomtype\">";
                html += obj[i].typename;
                html += "</td>\n" +
                    "            <td class=\"hidden-phone\" name=\"bedtype\">";
                html += obj[i].bedtype;
                html += "</td>\n" +
                    "            <td class=\"hidden-phone\" name=\"price\">";
                html += obj[i].price;
                html += "</td>\n" +
                    "            <td name=\"people\">";
                html += obj[i].people;
                html += "</td>\n" +
                    "                                <td>\n" +
                    "                                    <button class=\"btn btn-success btn-xs\" name=\"detail\"><i class=\"fa fa-exclamation-circle\"></i></button>\n" +
                    "                                    <button class=\"btn btn-primary btn-xs\" name=\"detail\"><i class=\"fa fa-pencil\"></i></button>\n" +
                    "                                    <button class=\"btn btn-danger btn-xs\"  name=\"delete\"><i class=\"fa fa-trash-o \"></i></button>\n" +
                    "                                </td>";
            }
            $("#table_content").html(html);
        }
        // 设置分页数量
        function setPage(pageNum) {
            console.log("分页数量" + pageNum);
            layui.use(['laypage','form'], function(){
                var form = layui.form;
                var laypage = layui.laypage;
                //执行一个laypage实例
                laypage.render({
                    elem: 'test1' //注意，这里的 test1 是 ID，不用加 # 号
                    ,count: pageNum //数据总数，从服务端得到
                    ,jump: function (obj,first) { // 分页获取数据
                        if(!first){
                            getData(obj.curr);
                        }
                    }
                });
                //监听指定开关
            });
        }
        // 搜索(本地查找，没有重新请求数据库)
        $("#search").click(function () {
            var name = $("#search_name").val();
            var result = [];
            var j = 0;
            // 寻找匹配的数据
            for(var i = 0; i < obj.length; i++) {
                if(name == obj[i].typename) {
                    result[j] = obj[i];
                    j++;
                }
            }
            initialTable(result);
        });

        // 详细信息和修改
        $("button[name='detail']").click(function () {
            alert("dfasdfsaefse");
            // 获取该类型的编号
            var R_roomtype = $(this).closest("tr").find("td[name='roomtype']").text();
            sessionStorage.setItem("R_roomtype",R_roomtype.trim());//页面之间传递数据
            window.open('./m_roomDetail.html','_self');
        });

        // 删除某一行
        $("button[name='delete']").click(function () {
            var temp = this;
            layer.open({
                content: '确定删除吗？'
                ,btn: ['删除', '取消']
                ,yes: function(index, layero){//删除
                    // temp.closest('tr').remove();
                    layer.closeAll();
                    var R_typename = temp.closest('tr').find("td[name='R_roomtype']").val().trim();
                    deleteData(R_typename,this)
                }
                ,btn2: function(index, layero){
                    //按钮【按钮二】的回调

                    //return false 开启该代码可禁止点击该按钮关闭
                }
                ,cancel: function(){
                    //右上角关闭回调

                    //return false 开启该代码可禁止点击该按钮关闭
                }
            });
        });

        // 根据房间编号删除相应的类型
        function deleteData(R_roomtype,temp) {
            alert(R_roomtype);
            // $.ajax({
            //     url: "/DeleteRoomTypeServlet",
            //     type:'post',
            //     data:{R_roomtype:R_roomtype},
            //     dataType:'text',
            //     success: function(data){
            //         // 后台删除失败
            //         if(data != 1) {
            //             showInsertResult("1删除失败！");
            //         } else {
            //             showInsertResult("删除成功！");
            //             temp.closest('tr').remove();// 移除某一行
            //         }
            //     },
            //     error: function () {
            //         showInsertResult("2删除失败！");
            //     }
            // });
        }

        // 现实插入的结果
        function showInsertResult(content) {
            layer.open({
                content: content
                ,btn: ['确定']
                ,yes: function(index, layero){//删除
                    layer.closeAll();
                }
                ,cancel: function(){
                }
            });
        }
        // 多选框
        // $('#multiopt').change(function () {
        //     if(this.checked){
        //         $("div[name='choose']").css('visibility','visible');
        //     } else {
        //         $("div[name='choose']").css('visibility','hidden');
        //     }
        // });
    });


</script>
</body>

</html>
