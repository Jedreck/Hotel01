<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Dashboard">
    <meta name="keyword" content="Dashboard, Bootstrap, Admin, Template, Theme, Responsive, Fluid, Retina">
    <title>详细信息</title>

    <!-- Favicons -->
    <link href="../../img/favicon.png" rel="icon">
    <link href="../../img/apple-touch-icon.png" rel="apple-touch-icon">

    <!-- Bootstrap core CSS -->
    <link href="../../lib/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <!--external css-->
    <link href="../../lib/font-awesome/css/font-awesome.css" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="../../css/zabuto_calendar.css">
    <link rel="stylesheet" type="text/css" href="../../lib/gritter/css/jquery.gritter.css" />
    <!-- Custom styles for this template -->
    <link href="../../css/style.css" rel="stylesheet">
    <link href="../../css/style-responsive.css" rel="stylesheet">
    <link rel="stylesheet" href="../../lib/layui/css/layui.css"  media="all">
    <script src="../../lib/chart-master/Chart.js"></script>

    <!-- =======================================================
      Template Name: Dashio
      Template URL: https://templatemag.com/dashio-bootstrap-admin-template/
      Author: TemplateMag.com
      License: https://templatemag.com/license/
    ======================================================= -->
</head>

<body>
<section id="container">
    <!-- **********************************************************************************************************************************************************
        TOP BAR CONTENT & NOTIFICATIONS
        *********************************************************************************************************************************************************** -->
    <!--header start-->
    <header class="header black-bg">
        <div class="sidebar-toggle-box">
            <div class="fa fa-bars tooltips" data-placement="right" data-original-title="Toggle Navigation"></div>
        </div>
        <!--logo start-->
        <a href="../common/index.html" class="logo"><b>酒店<span>预订</span></b></a>
        <!--logo end-->
        <div class="top-menu">
            <ul class="nav pull-right top-menu">
                <li><a class="logout" href="../common/index.html">登出</a></li>
            </ul>
        </div>
    </header>
    <!--header end-->
    <!-- **********************************************************************************************************************************************************
        MAIN SIDEBAR MENU
        *********************************************************************************************************************************************************** -->
    <!--sidebar start-->
    <aside>
        <div id="sidebar" class="nav-collapse ">
            <!-- sidebar menu start-->
            <ul class="sidebar-menu" id="nav-accordion">
                <p class="centered"><a href="profile.html"><img src="../../img/ui-sam.jpg" class="img-circle" width="80"></a></p>
                <h5 class="centered">Sam Soffes</h5>

                <li class="mt">
                    <a class="" href="#">
                        <i class="glyphicon glyphicon-home"></i>
                        <span>首页</span>
                    </a>
                </li>

                <li class="sub-menu">
                    <a class="active" href="javascript:;">
                        <i class="glyphicon glyphicon-pencil"></i>
                        <span>管理员管理</span>
                    </a>
                    <ul class="sub">
                        <li><a href="sm_managerlist.html">管理员列表</a></li>
                        <li><a href="sm_addManager.html">添加管理员</a></li>
                    </ul>
                </li>


            </ul>
            <!-- sidebar menu end-->
        </div>
    </aside>
    <!--sidebar end-->
    <!-- **********************************************************************************************************************************************************
        MAIN CONTENT
        *********************************************************************************************************************************************************** -->
    <!--main content start-->
    <section id="main-content">
        <section class="wrapper">
            <h3 style="margin-top: 10px"><i class="fa fa-angle-right"></i> (超级)管理员详细信息</h3>
            <div class="row mt">
                <!--  DATE PICKERS -->
                <div class="col-lg-12">
                    <div class="form-panel">
                        <form class="layui-form layui-form-pane" lay-filter="employeeInfo">

                            <div class="layui-form-item">
                                <label class="layui-form-label">员工编号:</label>
                                <div class="layui-input-block">
                                    <input type="text" name="E_num" autocomplete="off"
                                           placeholder="自动生成" class="layui-input" disabled>
                                </div>
                            </div>

                            <div class="layui-form form-group">
                                <label class="layui-form-label">身份证*：</label>
                                <div class="layui-input-block">
                                    <input type="text" name="E_ID" autocomplete="off" lay-verify="required|identity"
                                           placeholder="请输入员工身份证" class="layui-input">
                                </div>
                            </div>

                            <div class="layui-form-item">
                                <label class="layui-form-label">姓名:*</label>
                                <div class="layui-input-block">
                                    <input type="text" name="E_name" autocomplete="off" class="layui-input"
                                           lay-verify="required" placeholder="请输入姓名" >
                                </div>
                            </div>

                            <div class="layui-form-item">
                                <label class="layui-form-label">密码:*</label>
                                <div class="layui-input-block">
                                    <input type="text" name="E_password" autocomplete="off" class="layui-input"
                                           lay-verify="required" placeholder="请输入密码" >
                                </div>
                            </div>

                            <div class="layui-form-item" pane="">
                                <label class="layui-form-label">性别*</label>
                                <div class="layui-input-block">
                                    <input type="radio" name="E_sex" value="男" title="男" checked="">
                                    <input type="radio" name="E_sex" value="女" title="女">
                                </div>
                            </div>

                            <div class="layui-form form-group">
                                <label class="layui-form-label">职位*：</label>
                                <div class="layui-input-block">
                                    <select id="E_position" lay-filter="E_position" name="E_position" lay-verify="required">
                                        <option value=""></option>
                                        <option value="管理员" selected="">管理员</option>
                                        <option value="超级管理员">超级管理员</option>
                                    </select>
                                </div>
                            </div>


                            <div class="layui-form form-group">
                                <label class="layui-form-label">状态*：</label>
                                <div class="layui-input-block">
                                    <select id="E_status" lay-filter="E_status" name="E_status" lay-verify="required" disabled>
                                        <option value="在职">在职</option>
                                        <option value="已离职">已离职</option>
                                    </select>
                                </div>
                            </div>

                            <div class="layui-form-item">
                                <label class="layui-form-label">入职时间:*</label>
                                <div class="layui-input-block">
                                    <input type="text" id="E_hiredate" name="E_hiredate" autocomplete="off" class="layui-input"
                                           lay-verify="required|date" placeholder="请选择入职时间" >
                                </div>
                            </div>

                            <div class="layui-form-item">
                                <label class="layui-form-label">工资:*</label>
                                <div class="layui-input-block">
                                    <input type="text" name="E_salary" autocomplete="off" class="layui-input"
                                           lay-verify="required|number" placeholder="请填写工资" >
                                </div>
                            </div>

                            <div class="layui-form-item">
                                <label class="layui-form-label">地址:*</label>
                                <div class="layui-input-block">
                                    <input type="text" name="E_address" autocomplete="off" class="layui-input"
                                           lay-verify="required" placeholder="请输入地址" >
                                </div>
                            </div>

                            <div class="layui-form-item">
                                <label class="layui-form-label">电话:*</label>
                                <div class="layui-input-block">
                                    <input type="text" name="E_phone" autocomplete="off" class="layui-input"
                                           lay-verify="required|phone" placeholder="请输入电话" >
                                </div>
                            </div>

                            <div class="layui-form-item">
                                <button class="layui-btn" lay-submit lay-filter="submit">提交</button>
                                <button class="layui-btn layui-btn-danger" id="clearAll" type="reset">清空</button>
                            </div>
                        </form>
                    </div>
                    <!-- /form-panel -->
                </div>
                <!-- /col-lg-12 -->
            </div>
        </section>
        <!-- /wrapper -->
    </section>
    <!--main content end-->
    <!--footer start-->
    <footer class="site-footer">
        <div class="text-center">
            <p>
                &copy; Copyrights <strong>Dashio</strong>. All Rights Reserved
            </p>
            <div class="credits">
                <!--
                  You are NOT allowed to delete the credit link to TemplateMag with free version.
                  You can delete the credit link only if you bought the pro version.
                  Buy the pro version with working PHP/AJAX contact form: https://templatemag.com/dashio-bootstrap-admin-template/
                  Licensing information: https://templatemag.com/license/
                -->
                Created with Dashio template by <a href="https://templatemag.com/">TemplateMag</a>
            </div>
            <a href="index.html#" class="go-top">
                <i class="fa fa-angle-up"></i>
            </a>
        </div>
    </footer>
    <!--footer end-->

</section>
<!-- js placed at the end of the document so the pages load faster -->
<script src="../../lib/jquery/jquery.min.js"></script>

<script src="../../lib/bootstrap/js/bootstrap.min.js"></script>
<script class="include" type="text/javascript" src="../../lib/jquery.dcjqaccordion.2.7.js"></script>
<script src="../../lib/jquery.scrollTo.min.js"></script>
<script src="../../lib/jquery.nicescroll.js" type="text/javascript"></script>
<script src="../../lib/jquery.sparkline.js"></script>
<!--common script for all pages-->
<script src="../../lib/common-scripts.js"></script>
<script type="text/javascript" src="../../lib/gritter/js/jquery.gritter.js"></script>
<script type="text/javascript" src="../../lib/gritter-conf.js"></script>
<!--script for this page-->
<script src="../../lib/sparkline-chart.js"></script>
<script src="../../lib/zabuto_calendar.js"></script>


<script src="../../lib/layui/layui.js"></script>
<script>
    $(function () {
        initialData();
        layui.use(['form', 'layedit', 'laydate'], function () {
            var form = layui.form;
            var laydate = layui.laydate;
            form.on('submit(submit)', function (data) {//提交表单
                data.field.E_num;
                data.field.E_ID = data.field.E_ID + "";
                data.field.E_salary = parseFloat(data.field.E_salary);
                data.field.E_status = data.field.E_status == "在职" ? 1 : 0;
                var json = JSON.stringify(data.field);
                $.ajax({
                    url: "/UpdateEmployeeInfoServlet",
                    type:'post',
                    data:{employee:json},
                    dataType:'text',
                    success: function(data){
                        if(data == 0) {
                            showResult("修改员工信息失败，请重试！");
                        } else if(data == -1){
                            showResult("员工身份能相同，请重试!");
                        } else {
                            showResult("修改员工信息成功!");
                        }
                    }});
                return false;
            });
            laydate.render({
                elem: '#E_hiredate' //指定元素
                ,theme:'grid'
            });
        });

        function initialData() {
            var E_num = sessionStorage.getItem("E_num");
            // if(E_num == null) {
            //     showResult("非法访问！");
            //     window.location.href='../common/login.html';
            // }
            $.ajax({
                url: "/SelectEmployeeByENServlet",
                type:'post',
                data:{E_num:E_num},
                dataType:'text',
                success: function(data){
                    if(data == "Error") {
                        showResult("数据查询出错！");
                    } else {
                        var obj = JSON.parse(data);
                        initialForm(obj);
                    }
                }});
        }

        // 数据初始化
        function initialForm(employee) {
            console.log(employee.toString()+"dsfsd");
            layui.form.val("employeeInfo", { //表单初始化
                "E_num":employee.E_num,
                "E_ID":employee.E_ID,
                "E_name":employee.E_name,
                "E_password":employee.E_password,
                "E_sex":employee.E_sex,
                "E_position":employee.E_position,
                "E_status": employee.E_status == 1 ? "在职" : "已离职",
                "E_hiredate":employee.E_hiredate,
                "E_salary":employee.E_salary,
                "E_address":employee.E_address,
                "E_phone":employee.E_phone
            });
            layui.form.render();
        }

        $("#delete").click(function () {
            alert("dsfasdf");
            layer.open({
                content: '确定删除吗？'
                ,btn: ['删除', '取消']
                ,yes: function(index, layero){ //删除
                    layer.closeAll(); //关闭所有窗口
                    deleteData($("#E_num").val().trim());
                }
                ,btn2: function(index, layero){
                }
                ,cancel: function(){
                }
            });
        });



        // 根据员工号删除员工
        function deleteData(E_num) {
            $.ajax({
                url: "/DeleteEmployeeServlet",
                type:'post',
                data:{E_num:E_num},
                dataType:'text',
                success: function(data){
                    // 后台删除失败
                    if(data != 1) {
                        showResult("1删除失败！");
                    } else {
                        showResult("删除成功！");
                        window.open('./m_stalist.html','_self');
                    }
                },
                error: function () {
                    showResult("2删除失败！");
                }
            });
        }

        // 显示结果
        function showResult(content) {
            layer.open({
                content: content
                ,btn: ['确定']
                ,yes: function(index, layero){//删除
                    layer.closeAll();
                }
                ,cancel: function(){
                }
            });
        }

        // 验证信息是否正确
        function validateInfo(json) {
            var hintInfo = "";
            var tel_regexp="^((/(/d{3}/))|(/d{3}/-))?13[0-9]/d{8}|15[89]/d{8}";
            var idnum_regexp="/(^\\d{15}$)|(^\\d{18}$)|(^\\d{17}(\\d|X|x)$)/";
            var rw = true;
            if(json.E_name.length == ''){
                hintInfo += '姓名不能为空<br>';
                rw = false;
            }

            if(json.E_tel.length == ''){
                hintInfo += '手机号不能为空<br>';
                rw = false;
            } else if(!json.E_tel.match(tel_regexp)){
                hintInfo += '手机号格式不正确<br>';
                rw = false;
            }

            if(json.E_passwd.length == ''){
                hintInfo += '密码不能为空<br>';
                rw = false;
            }

            if(json.E_id.length == ''){
                hintInfo += '身份证不能为空<br>';
                rw = false;
            } else if(!json.E_id.match(idnum_regexp)){
                hintInfo += '身份证格式不正确';
                rw = false;
            }

            if(json.E_salary.length == ''){
                hintInfo += '薪资不能为空<br>';
                rw = false;
            }

            if(json.E_position.length == ''){
                hintInfo += '薪资不能为空<br>';
                rw = false;
            }

            if(json.E_status.length == ''){
                hintInfo += '薪资不能为空<br>';
                rw = false;
            }

            console.log(hintInfo);
            return {
                rw:rw,
                hintInfo:hintInfo
            };
        }
    });

</script>


</body>

</html>
